<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Accessibility Audit - Color Contrast</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
    }
    h1 { color: #333; }
    .audit-section {
      background: white;
      padding: 20px;
      margin: 20px 0;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .color-pair {
      display: flex;
      align-items: center;
      gap: 20px;
      margin: 15px 0;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    .color-preview {
      flex: 1;
      padding: 20px;
      border-radius: 4px;
      font-weight: 500;
    }
    .ratio-result {
      flex: 1;
      font-size: 18px;
      font-weight: bold;
    }
    .pass { color: #28a745; }
    .fail { color: #d73a49; }
    .colors { font-family: monospace; font-size: 14px; color: #666; margin-top: 5px; }
  </style>
</head>
<body>
  <h1>üé® GitHub Stats Spark - Color Contrast Audit</h1>
  <p><strong>WCAG 2.1 Level AA Requirements:</strong></p>
  <ul>
    <li>Normal text (body): 4.5:1 minimum</li>
    <li>Large text (18px+ or 14px+ bold): 3:1 minimum</li>
    <li>UI components & graphics: 3:1 minimum</li>
  </ul>

  <div id="results"></div>

  <script>
    // Color definitions from global.css
    const colors = {
      // Primary colors
      primary: '#0366d6',
      primaryDark: '#0256c2',
      primaryLight: '#2b7de9',
      
      // Neutrals
      background: '#ffffff',
      surface: '#f6f8fa',
      surfaceAlt: '#e1e4e8',
      border: '#d1d5da',
      text: '#24292e',
      textSecondary: '#586069',
      textMuted: '#6a737d',
      
      // Semantic
      success: '#28a745',
      warning: '#ffd33d',
      error: '#d73a49',
      info: '#0366d6'
    };

    // Calculate relative luminance
    function getLuminance(hex) {
      const rgb = parseInt(hex.slice(1), 16);
      const r = (rgb >> 16) & 0xff;
      const g = (rgb >> 8) & 0xff;
      const b = (rgb >> 0) & 0xff;
      
      const [rs, gs, bs] = [r, g, b].map(c => {
        c = c / 255;
        return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
      });
      
      return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
    }

    // Calculate contrast ratio
    function getContrastRatio(hex1, hex2) {
      const lum1 = getLuminance(hex1);
      const lum2 = getLuminance(hex2);
      const lighter = Math.max(lum1, lum2);
      const darker = Math.min(lum1, lum2);
      return (lighter + 0.05) / (darker + 0.05);
    }

    // Test color pairs
    const tests = [
      // Text on backgrounds
      { fg: 'text', bg: 'background', use: 'Body text', req: 4.5 },
      { fg: 'textSecondary', bg: 'background', use: 'Secondary text', req: 4.5 },
      { fg: 'textMuted', bg: 'background', use: 'Muted text', req: 4.5 },
      { fg: 'text', bg: 'surface', use: 'Text on surface', req: 4.5 },
      { fg: 'textSecondary', bg: 'surfaceAlt', use: 'Secondary on alt surface', req: 4.5 },
      
      // Links
      { fg: 'primary', bg: 'background', use: 'Primary links', req: 4.5 },
      { fg: 'primaryDark', bg: 'background', use: 'Primary links hover', req: 4.5 },
      
      // Buttons
      { fg: 'background', bg: 'primary', use: 'Primary button text', req: 4.5 },
      { fg: 'background', bg: 'primaryDark', use: 'Primary button hover', req: 4.5 },
      { fg: 'textSecondary', bg: 'surfaceAlt', use: 'Secondary button', req: 3 },
      
      // UI Components
      { fg: 'border', bg: 'background', use: 'Border (graphic)', req: 3 },
      { fg: 'success', bg: 'background', use: 'Success indicator', req: 3 },
      { fg: 'error', bg: 'background', use: 'Error indicator', req: 3 },
      { fg: 'warning', bg: 'background', use: 'Warning text', req: 4.5 }
    ];

    const results = document.getElementById('results');
    
    tests.forEach(test => {
      const fgColor = colors[test.fg];
      const bgColor = colors[test.bg];
      const ratio = getContrastRatio(fgColor, bgColor);
      const passes = ratio >= test.req;
      
      const section = document.createElement('div');
      section.className = 'audit-section';
      section.innerHTML = `
        <h3>${test.use}</h3>
        <div class="color-pair">
          <div class="color-preview" style="color: ${fgColor}; background: ${bgColor};">
            Sample Text Aa
          </div>
          <div class="ratio-result ${passes ? 'pass' : 'fail'}">
            ${ratio.toFixed(2)}:1
            <div style="font-size: 14px; font-weight: normal; margin-top: 5px;">
              Required: ${test.req}:1<br>
              ${passes ? '‚úÖ PASS' : '‚ùå FAIL'}
            </div>
          </div>
        </div>
        <div class="colors">
          Foreground: ${fgColor} (${test.fg})<br>
          Background: ${bgColor} (${test.bg})
        </div>
      `;
      results.appendChild(section);
    });

    // Summary
    const passCount = tests.filter(t => {
      const ratio = getContrastRatio(colors[t.fg], colors[t.bg]);
      return ratio >= t.req;
    }).length;
    
    const summary = document.createElement('div');
    summary.className = 'audit-section';
    summary.style.background = passCount === tests.length ? '#d4edda' : '#f8d7da';
    summary.innerHTML = `
      <h2>Summary</h2>
      <p style="font-size: 20px; font-weight: bold;">
        ${passCount} of ${tests.length} color pairs pass WCAG AA requirements
        ${passCount === tests.length ? '‚úÖ' : '‚ùå'}
      </p>
    `;
    results.insertBefore(summary, results.firstChild);
  </script>
</body>
</html>
