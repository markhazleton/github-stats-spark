import{r as e,C as t,a,j as s}from"./site-BiYgNJqb.js";import{d as i,L as r,P as o}from"./site-BSQ-rtDu.js";t.register(...a);const n={responsive:!0,maintainAspectRatio:!1,devicePixelRatio:window.devicePixelRatio||1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!0,position:"bottom",labels:{padding:16,font:{size:14},usePointStyle:!0,boxWidth:8,boxHeight:8}},tooltip:{enabled:!0,mode:"index",intersect:!1,backgroundColor:"rgba(0, 0, 0, 0.9)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"rgba(255, 255, 255, 0.2)",borderWidth:1,cornerRadius:8,padding:12,displayColors:!0,callbacks:{title:e=>e[0]?.label||"",label:e=>{const t=e.dataset.label||"",a=null!==e.parsed.y?e.parsed.y:e.parsed;return`${t}: ${"number"==typeof a?a.toLocaleString():a}`}},position:"average",yAlign:"bottom",xAlign:"center"}},scales:{x:{grid:{display:!1},ticks:{font:{size:12},maxRotation:45,minRotation:0,autoSkip:!0,maxTicksLimit:10}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)",drawBorder:!1},ticks:{font:{size:12},callback:e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e}}},animation:{duration:750,easing:"easeInOutQuart"}};const l=new class{constructor(){this.touchTimeout=null,this.touchStartTime=0,this.touchPosition=null}beforeEvent(e,t){const a=t.event;if("touchstart"===a.type)this.touchStartTime=Date.now(),this.touchPosition={x:a.x,y:a.y},this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>{if(e.tooltip){const t=e.getElementsAtEventForMode(a,"nearest",{intersect:!1},!1);t.length>0&&(e.tooltip.setActiveElements(t),e.update("none"))}},300);else if("touchmove"===a.type){if(this.touchPosition){Math.sqrt(Math.pow(a.x-this.touchPosition.x,2)+Math.pow(a.y-this.touchPosition.y,2))>10&&clearTimeout(this.touchTimeout)}}else"touchend"!==a.type&&"touchcancel"!==a.type||(clearTimeout(this.touchTimeout),this.touchPosition=null)}},c=({type:a,data:o,options:c={},title:d,enableHorizontalScroll:h=!0,maxDataPoints:u=10,loading:p=!1,error:m=null,emptyMessage:g="No data to display",className:b=""})=>{const{width:f,height:x}=((t={})=>{const{minHeight:a=300,maxHeight:s=600,mobileAspectRatio:r=1.5,desktopAspectRatio:o=2,breakpoint:n=768}=t,[l,c]=e.useState({width:window.innerWidth,height:a});return e.useEffect(()=>{const e=()=>{const e=window.innerWidth<n,t=Math.min(window.innerWidth-32,1200);let i=t/(e?r:o);i=Math.max(a,Math.min(s,i)),c({width:t,height:i})},t=i(e,150);return e(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[a,s,r,o,n]),l})({minHeight:300,maxHeight:500,mobileAspectRatio:1.2,desktopAspectRatio:2.5}),y=e.useRef(null),w=h&&o?.labels?.length>u,v=e.useMemo(()=>{if(w&&o?.labels?.length){const e=window.innerWidth<768?60:80,t=o.labels.length*e;return Math.max(f,t)}return f},[w,o?.labels?.length,f]),j=w?o:{...o,labels:o?.labels?.slice(0,u)||[],datasets:o?.datasets?.map(e=>({...e,data:e.data?.slice(0,u)||[]}))||[]},{canvasRef:T}=(a=>{const s=e.useRef(null),r=e.useRef(null),[o,c]=e.useState(!1),{type:d,data:h,options:u={},enableTouchAndHold:p=!0,debounceDelay:g=150}=a,b=e.useCallback(()=>{const e={...n,...u,plugins:{...n.plugins,...u.plugins,tooltip:{...n.plugins.tooltip,...u.plugins?.tooltip},legend:{...n.plugins.legend,...u.plugins?.legend}},scales:{...n.scales,...u.scales}};return"pie"!==d&&"doughnut"!==d||delete e.scales,e},[d,u]),f=e.useCallback(()=>{if(s.current&&h){r.current&&r.current.destroy();try{const e=s.current.getContext("2d"),a={type:d,data:h,options:b(),plugins:p?[l]:[]};r.current=new t(e,a),c(!0)}catch(m){}}},[d,h,b,p]),x=e.useCallback(e=>{if(r.current)try{r.current.data=e,r.current.update("active")}catch(m){}},[]),y=e.useCallback(()=>{r.current&&(r.current.destroy(),r.current=null,c(!1))},[]);return e.useEffect(()=>{const e=i(()=>{r.current&&r.current.resize()},g);return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[g]),e.useEffect(()=>{const e=setTimeout(()=>{f()},0);return()=>{clearTimeout(e),y()}},[f,y]),e.useEffect(()=>{o&&h&&x(h)},[h,o,x]),{canvasRef:s,updateChart:x,destroyChart:y,isReady:o}})({type:a,data:j,options:{...c,maintainAspectRatio:!1},enableTouchAndHold:!0,debounceDelay:150});return p?s.jsxs("div",{className:`chart-wrapper ${b}`,children:[d&&s.jsx("h3",{className:"chart-title",children:d}),s.jsx("div",{className:"chart-loading",children:s.jsx(r,{type:"chart"})})]}):m?s.jsxs("div",{className:`chart-wrapper ${b}`,children:[d&&s.jsx("h3",{className:"chart-title",children:d}),s.jsxs("div",{className:"chart-error",children:[s.jsx("p",{children:"⚠️ Error loading chart"}),s.jsx("p",{className:"chart-error-message",children:m})]})]}):o&&o.labels&&0!==o.labels.length?s.jsxs("div",{className:`chart-wrapper ${b}`,children:[d&&s.jsx("h3",{className:"chart-title",children:d}),w&&s.jsx("div",{className:"chart-scroll-hint",children:"← Scroll to see more data →"}),s.jsx("div",{ref:y,className:"chart-container "+(w?"chart-scrollable":""),style:{height:`${x}px`},children:s.jsx("div",{className:"chart-canvas-wrapper",style:{width:w?`${v}px`:"100%",height:"100%"},children:s.jsx("canvas",{ref:T,role:"img","aria-label":d||"Chart visualization"})})}),w&&o.labels.length>u&&s.jsxs("div",{className:"chart-data-info",children:["Showing ",o.labels.length," data points (scroll to view all)"]})]}):s.jsxs("div",{className:`chart-wrapper ${b}`,children:[d&&s.jsx("h3",{className:"chart-title",children:d}),s.jsx("div",{className:"chart-empty",children:s.jsx("p",{children:g})})]})};c.propTypes={type:o.oneOf(["bar","line","pie","doughnut","scatter"]).isRequired,data:o.shape({labels:o.arrayOf(o.string),datasets:o.arrayOf(o.shape({label:o.string,data:o.arrayOf(o.number),backgroundColor:o.oneOfType([o.string,o.arrayOf(o.string)]),borderColor:o.oneOfType([o.string,o.arrayOf(o.string)])}))}).isRequired,options:o.object,title:o.string,enableHorizontalScroll:o.bool,maxDataPoints:o.number,loading:o.bool,error:o.string,emptyMessage:o.string,className:o.string};export{c as C};
