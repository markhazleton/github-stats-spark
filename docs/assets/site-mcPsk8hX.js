import{r as e,C as t,a,j as s}from"./site-Dt-bvWfg.js";import{d as i,L as r,P as n}from"./site-CeYNY0Mm.js";t.register(...a);const o={responsive:!0,maintainAspectRatio:!1,devicePixelRatio:window.devicePixelRatio||1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!0,position:"bottom",labels:{padding:16,font:{size:14},usePointStyle:!0,boxWidth:8,boxHeight:8}},tooltip:{enabled:!0,mode:"index",intersect:!1,backgroundColor:"rgba(0, 0, 0, 0.9)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"rgba(255, 255, 255, 0.2)",borderWidth:1,cornerRadius:8,padding:12,displayColors:!0,callbacks:{title:e=>e[0]?.label||"",label:e=>{const t=e.dataset.label||"",a=null!==e.parsed.y?e.parsed.y:e.parsed;return`${t}: ${"number"==typeof a?a.toLocaleString():a}`}},position:"average",yAlign:"bottom",xAlign:"center"}},scales:{x:{grid:{display:!1},ticks:{font:{size:12},maxRotation:45,minRotation:0,autoSkip:!0,maxTicksLimit:10}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)",drawBorder:!1},ticks:{font:{size:12},callback:e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e}}},animation:{duration:750,easing:"easeInOutQuart"}};const l=new class{constructor(){this.touchTimeout=null,this.touchStartTime=0,this.touchPosition=null}beforeEvent(e,t){const a=t.event;if("touchstart"===a.type)this.touchStartTime=Date.now(),this.touchPosition={x:a.x,y:a.y},this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>{if(e.tooltip){const t=e.getElementsAtEventForMode(a,"nearest",{intersect:!1},!1);t.length>0&&(e.tooltip.setActiveElements(t),e.update("none"))}},300);else if("touchmove"===a.type){if(this.touchPosition){Math.sqrt(Math.pow(a.x-this.touchPosition.x,2)+Math.pow(a.y-this.touchPosition.y,2))>10&&clearTimeout(this.touchTimeout)}}else"touchend"!==a.type&&"touchcancel"!==a.type||(clearTimeout(this.touchTimeout),this.touchPosition=null)}},c=({type:a,data:n,options:c={},title:d,enableHorizontalScroll:h=!0,maxDataPoints:u=10,loading:p=!1,error:m=null,emptyMessage:g="No data to display",className:b=""})=>{const{width:f,height:x}=((t={})=>{const{minHeight:a=300,maxHeight:s=600,mobileAspectRatio:r=1.5,desktopAspectRatio:n=2,breakpoint:o=768}=t,[l,c]=e.useState({width:window.innerWidth,height:a});return e.useEffect(()=>{const e=()=>{const e=window.innerWidth<o,t=Math.min(window.innerWidth-32,1200);let i=t/(e?r:n);i=Math.max(a,Math.min(s,i)),c({width:t,height:i})},t=i(e,150);return e(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[a,s,r,n,o]),l})({minHeight:300,maxHeight:500,mobileAspectRatio:1.2,desktopAspectRatio:2.5}),[y,w]=e.useState(f),v=e.useRef(null),j=h&&n?.labels?.length>u;e.useEffect(()=>{if(j&&n?.labels?.length){const e=window.innerWidth<768?60:80,t=n.labels.length*e;w(Math.max(f,t))}else w(f)},[j,n?.labels?.length,f,u]);const N=j?n:{...n,labels:n?.labels?.slice(0,u)||[],datasets:n?.datasets?.map(e=>({...e,data:e.data?.slice(0,u)||[]}))||[]},{canvasRef:R}=(a=>{const s=e.useRef(null),r=e.useRef(null),[n,c]=e.useState(!1),{type:d,data:h,options:u={},enableTouchAndHold:p=!0,debounceDelay:g=150}=a,b=e.useCallback(()=>{const e={...o,...u,plugins:{...o.plugins,...u.plugins,tooltip:{...o.plugins.tooltip,...u.plugins?.tooltip},legend:{...o.plugins.legend,...u.plugins?.legend}},scales:{...o.scales,...u.scales}};return"pie"!==d&&"doughnut"!==d||delete e.scales,e},[d,u]),f=e.useCallback(()=>{if(s.current&&h){r.current&&r.current.destroy();try{const e=s.current.getContext("2d"),a={type:d,data:h,options:b(),plugins:p?[l]:[]};r.current=new t(e,a),c(!0)}catch(m){}}},[d,h,b,p]),x=e.useCallback(e=>{if(r.current)try{r.current.data=e,r.current.update("active")}catch(m){}},[]),y=e.useCallback(()=>{r.current&&(r.current.destroy(),r.current=null,c(!1))},[]);return e.useEffect(()=>{const e=i(()=>{r.current&&r.current.resize()},g);return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[g]),e.useEffect(()=>(f(),()=>{y()}),[f,y]),e.useEffect(()=>{n&&h&&x(h)},[h,n,x]),{canvasRef:s,chartInstance:r.current,updateChart:x,destroyChart:y,isReady:n}})({type:a,data:N,options:{...c,maintainAspectRatio:!1},enableTouchAndHold:!0,debounceDelay:150});return p?s.jsxs("div",{className:`chart-wrapper ${b}`,children:[d&&s.jsx("h3",{className:"chart-title",children:d}),s.jsx("div",{className:"chart-loading",children:s.jsx(r,{type:"chart"})})]}):m?s.jsxs("div",{className:`chart-wrapper ${b}`,children:[d&&s.jsx("h3",{className:"chart-title",children:d}),s.jsxs("div",{className:"chart-error",children:[s.jsx("p",{children:"⚠️ Error loading chart"}),s.jsx("p",{className:"chart-error-message",children:m})]})]}):n&&n.labels&&0!==n.labels.length?s.jsxs("div",{className:`chart-wrapper ${b}`,children:[d&&s.jsx("h3",{className:"chart-title",children:d}),j&&s.jsx("div",{className:"chart-scroll-hint",children:"← Scroll to see more data →"}),s.jsx("div",{ref:v,className:"chart-container "+(j?"chart-scrollable":""),style:{height:`${x}px`},children:s.jsx("div",{className:"chart-canvas-wrapper",style:{width:j?`${y}px`:"100%",height:"100%"},children:s.jsx("canvas",{ref:R,role:"img","aria-label":d||"Chart visualization"})})}),j&&n.labels.length>u&&s.jsxs("div",{className:"chart-data-info",children:["Showing ",n.labels.length," data points (scroll to view all)"]})]}):s.jsxs("div",{className:`chart-wrapper ${b}`,children:[d&&s.jsx("h3",{className:"chart-title",children:d}),s.jsx("div",{className:"chart-empty",children:s.jsx("p",{children:g})})]})};c.propTypes={type:n.oneOf(["bar","line","pie","doughnut","scatter"]).isRequired,data:n.shape({labels:n.arrayOf(n.string),datasets:n.arrayOf(n.shape({label:n.string,data:n.arrayOf(n.number),backgroundColor:n.oneOfType([n.string,n.arrayOf(n.string)]),borderColor:n.oneOfType([n.string,n.arrayOf(n.string)])}))}).isRequired,options:n.object,title:n.string,enableHorizontalScroll:n.bool,maxDataPoints:n.number,loading:n.bool,error:n.string,emptyMessage:n.string,className:n.string};export{c as C};
